<div class="whole-body" *ngIf="!isEmployee()">
  <div *ngIf="!isActive">
  <div class="sticky-top">
    <app-header></app-header></div>
    <div class="sidebar-content d-flex">
    <div class="sidebar">
    <app-sidebar></app-sidebar>
    </div></div>
  </div>
  <div *ngIf="isActive" class="closeBtnDiv">
    <button class="btn btn-danger mb-5 close-btn" mat-dialog-close="true">Close</button>
  </div>  
    <div class="container content-container mt-5" id="content-wrapper"    [ngClass]="{ 'employee-view': isActive }">
    <!-- <div class="row">
      <div class="col-md-6">
        <button class="btn btn-primary" routerLink="employee/add">
          Add Employee
        </button>
      </div>
      <div class="col-6 d-flex">
        <input
          type="text"
          class="input-field"
          placeholder="Search "
          [(ngModel)]="search"
          (keyup.enter)="onSearch()"
        >
        <i class="mdi mdi-window-close cancel-icon" (click)="clearSearch()"></i>
        <button
          class="btn search-btn btn-primary ms-2 btn-sm"
          (click)="onSearch()" >
          SEARCH
        </button>
        <div  *ngIf="isActive">
          <button class="btn ms-3 btn-danger" mat-dialog-close="true">Close</button>
        </div>
      </div>
    </div> -->
 
    <div class="row searchbar">
      <div class="col-md-6 ">
        <button class="button-expo" routerLink="employee/add">ADD EMPLOYEE</button>
      </div>
      <div class="col-md-6 d-flex justify-content-end">
        <div class="input-container">
          <input
            type="text"
            class="input-box"
            placeholder="Search"
            [(ngModel)]="search"
            (keyup.enter)="onSearch()">
          <i class="mdi mdi-window-close cancel-icon" (click)="clearSearch()"></i>
        </div>
        <button class="btn searchBtn ms-2" (click)="onSearch()">SEARCH</button>
      </div>
    </div>
  <div class="container mt-5 ">
    <div class="row">
      <div class="col-md-12">
        <button
        class="btn"
        [ngClass]="{ 'btn-primary': selectedRole === '', 'btn-outline-primary': selectedRole !== '' }"
        (click)="filterByRole('')">
        All Data ({{totalEntriesCount}})
      </button>
        <button
          class="btn ms-2"
          [ngClass]="{ 'btn-primary': selectedRole === 'SuperAdmin', 'btn-outline-primary': selectedRole !== 'SuperAdmin' }"
          (click)="filterByRole('SuperAdmin')"
        >
          SuperAdmin ({{superAdminCount}})
        </button>
        <button
          class="btn ms-2"
          [ngClass]="{ 'btn-primary': selectedRole === 'Admin', 'btn-outline-primary': selectedRole !== 'Admin' }"
          (click)="filterByRole('Admin')"
        >
          Admin ({{adminCount}})
        </button>
        <button
          class="btn ms-2"
          [ngClass]="{ 'btn-primary': selectedRole === 'Employee', 'btn-outline-primary': selectedRole !== 'Employee' }"
          (click)="filterByRole('Employee')"
        >
          Employee ({{employeeCount}})
        </button>
      </div>
    </div>
  </div>
  <div class="container mt-5 ps-0 pe-0">
    <div class="row">
      <div class="col-12 ps-0 pe-0 ">
        <table class="table table-dark align-start table-striped shadow-lg">
          <thead>
            <tr>
              <th class="py-3 ps-3 bg-success">S.No</th>
              <th class="py-3 ps-3 bg-success" (click)="sortDep('name')">
                NAME 
                <i class="mdi" 
                [ngClass]="{
                  'mdi-menu-up': EmployeeFilterObj.sortBy === 'name' && EmployeeFilterObj.isAscending, 
                  'mdi-menu-down': EmployeeFilterObj.sortBy === 'name' && !EmployeeFilterObj.isAscending
                }" >
             </i></th>
              <th
                class="py-3 ps-3 bg-success"
                (click)="sortDep('departmentName')"
              >
                DEPARTMENT 
                <i class="mdi" 
                [ngClass]="{
                  'mdi-menu-up': EmployeeFilterObj.sortBy === 'departmentName' && EmployeeFilterObj.isAscending, 
                  'mdi-menu-down': EmployeeFilterObj.sortBy === 'departmentName' && !EmployeeFilterObj.isAscending
                }" >
             </i>
              </th>
              <th class="py-3 ps-3 bg-success" (click)="sortDep('createdOn')">
                CREATED ON
                <i class="mdi" 
                [ngClass]="{
                  'mdi-menu-up': EmployeeFilterObj.sortBy === 'createdOn' && EmployeeFilterObj.isAscending, 
                  'mdi-menu-down': EmployeeFilterObj.sortBy === 'createdOn' && !EmployeeFilterObj.isAscending
                }" >
             </i>
               </th>
              <th class="py-3 ps-3 bg-success" (click)="sortDep('createdBy')">
                CREATED BY 
                <i class="mdi" 
                [ngClass]="{
                  'mdi-menu-up': EmployeeFilterObj.sortBy === 'createdBy' && EmployeeFilterObj.isAscending, 
                  'mdi-menu-down': EmployeeFilterObj.sortBy === 'createdBy' && !EmployeeFilterObj.isAscending
                }" >
             </i>
              </th>
              <th class="py-3 ps-3 bg-success" (click)="sortDep('salary')">
                SALARY 
                <i class="mdi" 
                [ngClass]="{
                  'mdi-menu-up': EmployeeFilterObj.sortBy === 'salary' && EmployeeFilterObj.isAscending, 
                  'mdi-menu-down': EmployeeFilterObj.sortBy === 'salary' && !EmployeeFilterObj.isAscending
                }" >
             </i>              </th>
              <th class="py-3 ps-3 bg-success" (click)="sortDep('role')" *ngIf="selectedRole==''">
                ROLE
                <i class="mdi" 
                [ngClass]="{
                  'mdi-menu-up': EmployeeFilterObj.sortBy === 'role' && EmployeeFilterObj.isAscending, 
                  'mdi-menu-down': EmployeeFilterObj.sortBy === 'role' && !EmployeeFilterObj.isAscending
                }" >
             </i>
              </th>
              <th class="py-3 ps-3 bg-success" (click)="sortDep('adminName')">
                MANAGER 
                <i class="mdi" 
                [ngClass]="{
                  'mdi-menu-up': EmployeeFilterObj.sortBy === 'adminName' && EmployeeFilterObj.isAscending, 
                  'mdi-menu-down': EmployeeFilterObj.sortBy === 'adminName' && !EmployeeFilterObj.isAscending
                }" >
             </i>              </th>
              <th class="py-3 ps-3 bg-success">ACTION</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of employeeList; let i = index">
              <td class="text-center">{{ getGlobalIndex(i) }}</td>
              <td class="text-start ps-2">{{ item.name }}</td>
              <td class="text-start ps-2">{{ item.departmentName }}</td>
              <td class="text-start ps-2">{{ item.createdOn | date:'dd/MM/yyyy , h:mm a' }}</td>
              <td class="text-start ps-2">{{ item.createdBy }}</td>
              <td class="text-start ps-2">{{ item.salary }}</td>
              <td class="text-start ps-2" *ngIf="selectedRole === ''">  
                <div *ngIf="item.role === 0" >Employee</div> 
                <div *ngIf="item.role === 1" >Admin</div>
                <div *ngIf="item.role === 2" > SuperAdmin</div> 
              </td>
              <td class="text-start ps-2">{{ item.adminName }}</td>
              <td class="text-center d-flex">
                <div *ngIf="!isActive">
                <button class="btn deleteBtn btn-sm" (click)="delete(item.id)">
                  DELETE
                </button>
              </div>
              <div *ngIf="!isActive" >
                <button
                  class="btn updateBtn btn-sm ms-2"
                  [routerLink]="['edit', item.id]"
                >
                  UPDATE
                </button></div>
               <div>
                <!-- <div class="d-flex">
                  <div  *ngIf="isActive && !MemberAlreadyExist(item.id)">
                    <button class="btn btn-success" (click)="addMemberFun(item.id,item.name)">Add</button>
                  </div>
                  <div  *ngIf="isActive && MemberAlreadyExist(item.id)">
                    <button class="btn btn-success" (click)="addMemberFun(item.id,item.name)">Remove</button>
                  </div>
                </div> -->
                <div class="d-flex">
                  <div *ngIf="isActive">
                    <button 
                      class="btn btn-success" 
                      (click)="toggleMemberStatus(item.id, item.name)">
                      {{ MemberAlreadyExist(item.id) ? 'Remove' : 'Add' }}
                    </button>
                  </div>
                </div>
                
               </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <!-- <div class="d-flex justify-centent-end">
    <div *ngIf="isActive">
      <button [mat-dialog-close]="SelectedEmployeeList">Save</button>
    </div>
    <div *ngIf="isActive">
      <button mat-dialog-close="true">Cancel</button>
    </div>
  </div> -->
  <div class="container mt-5">
    <div class="row">
      <div class="col-6 mb-5 paginator-parent">
        <mat-paginator
          class="pagination shadow mat-mdc-paginator-container"
          [length]="rolesentriesCount ? displayedEntriesCount : totalEntriesCount"
          [pageSize]="EmployeeFilterObj.pageSize"
          [pageSizeOptions]="[5, 10, 20, 50]"
          aria-label="Select page"
          (page)="onPageEvent($event)"
        >
        </mat-paginator>
      </div>
      <div class="col-6">
        <!-- {{getMaxPage()}} -->
        <input
          type="number"
          [min]="1"
          [max]="maxPage"
          [(ngModel)]="pageInput"
          (keyup.enter)="goToPage()"
          class="form-control go-input text-center me-2"
        >
        <button class="btn btn-primary go-btn" (click)="goToPage()">GO</button>
        <div *ngIf="errorMsg" class="error-message text-danger">
          {{ errorMsg }}
        </div>
      </div>
    </div>
  </div>
  <div class="d-flex cancelAddBtn ">
    <div  *ngIf="isActive">
      <button class="btn btn-success" [mat-dialog-close]="projectMembers">Save</button>
    </div>
    <div  *ngIf="isActive" class="ms-2">
      <button class="btn btn-danger" mat-dialog-close="true">Cancel</button>
    </div>
  </div>
</div>
</div>
